<!DOCTYPE html>
<html>
<head>
	<title></title>
	<div>
		<a id="open-async" href="#">Open link (after asynchronous ajax)</a>
	</div>

	<div>
		<a id="open-sync" href="#">Open link (after synchronous ajax)</a>
	</div>
</head>
<body>
	<script>
		var openAsyncLink = document.getElementById("open-async");
		
		openAsyncLink.addEventListener("click", function() {
			return new Promise(function(resolve, reject) {
					var xhr = new XMLHttpRequest();
					xhr.open('GET', 'https://jsonplaceholder.typicode.com/posts/1', true);
					xhr.onload = function() {
						resolve();
					};
				xhr.send();
			})
			.then(function() {
				window.open("https://www.if.fi");
			});
		});


		var openSyncLink = document.getElementById("open-sync");
		
		openSyncLink.addEventListener("click", function() {
			return new Promise(function(resolve, reject) {
					var xhr = new XMLHttpRequest();
					xhr.open('GET', 'https://jsonplaceholder.typicode.com/posts/1', false);
					xhr.onload = function() {
						resolve();
					};
				xhr.send();
			})
			.then(function() {
				window.open("https://www.if.fi");
			});
		});
	</script>
</body>
</html>