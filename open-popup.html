<!DOCTYPE html>
<html>
<head>
	<title></title>
	<a id="open-ok" href="#">Open link</a>
	<a id="open-blocked" href="#">Open link (blocked)</a>
</head>
<body>
	<script>
		var okLink = document.getElementById("open-ok");

		okLink.addEventListener("click", function() {
			window.open("https://www.if.fi");
		});

		var blockedLink = document.getElementById("open-blocked");
		
		blockedLink.addEventListener("click", function() {
			return new Promise(function(resolve, reject) {
					var xhr = new XMLHttpRequest();
					xhr.open('GET', 'https://example.com');
					xhr.onload = function() {
						resolve();
					};
				xhr.send();
			})
			.then(function() {
				window.open("https://www.if.fi");
			});
		});
	</script>
</body>
</html>